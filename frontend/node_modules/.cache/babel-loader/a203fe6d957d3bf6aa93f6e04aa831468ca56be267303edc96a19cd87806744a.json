{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[token,setToken]=useState(null);const[loading,setLoading]=useState(true);const[advisorData,setAdvisorData]=useState(null);useEffect(()=>{const initializeAuth=async()=>{try{// First, check if we're running in Cloud Run by testing the metadata server\nconst isCloudRun=await checkCloudRunEnvironment();if(isCloudRun){// Get service account identity token for the backend\nconst backendUrl=process.env.REACT_APP_API_URL||'https://apialchemistproject-backend-608187465720.us-central1.run.app';const identityToken=await getServiceAccountToken(backendUrl);if(identityToken){setToken(identityToken);setUser({authenticated:true,serviceAccount:true});console.log('Service account authentication successful');}else{throw new Error('Failed to get service account token');}}else{// Local development - use stored token or require sign in\nconst savedToken=localStorage.getItem('gcp_token');if(savedToken){setToken(savedToken);setUser({authenticated:true,serviceAccount:false});}// If no saved token, user will need to sign in manually\n}}catch(error){console.log('Service account auth not available:',error.message);// Fall back to checking for saved user token\nconst savedToken=localStorage.getItem('gcp_token');if(savedToken){setToken(savedToken);setUser({authenticated:true,serviceAccount:false});}}finally{setLoading(false);}};initializeAuth();},[]);const checkCloudRunEnvironment=async()=>{try{// Check if we're on Cloud Run by hostname instead of metadata service\nconst isCloudRun=window.location.hostname.includes('run.app');console.log('ðŸ” Environment check - Cloud Run:',isCloudRun);return isCloudRun;}catch(error){return false;}};const getServiceAccountToken=async audience=>{try{const response=await fetch(`http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/identity?audience=${encodeURIComponent(audience)}`,{headers:{'Metadata-Flavor':'Google'}});if(response.ok){return await response.text();}else{throw new Error(`Failed to get token: ${response.status}`);}}catch(error){console.error('Error getting service account token:',error);return null;}};// Function to fetch advisor data by email from BigQuery\nconst fetchAdvisorByEmail=async email=>{try{const apiUrl=process.env.REACT_APP_API_URL||'https://apialchemistproject-backend-608187465720.us-central1.run.app';console.log('Fetching advisor for email:',email,'from API:',apiUrl);const response=await fetch(`${apiUrl}/advisor-by-email`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:email})});if(response.ok){const result=await response.json();if(result.advisor){console.log('âœ… Found advisor in database:',result.advisor);setAdvisorData(result.advisor);localStorage.setItem('advisor_data',JSON.stringify(result.advisor));return result.advisor;}else{throw new Error('Advisor not found in database response');}}else{console.error('API Error:',response.status,response.statusText);throw new Error(`API Error: ${response.status}`);}}catch(error){console.error('âŒ Error fetching advisor data for email:',email,error);// Default to advisor ADV001 (first advisor) from the database\ntry{console.log('ðŸ”„ Attempting to fetch default advisor (ADV001)...');const apiUrl=process.env.REACT_APP_API_URL||'https://apialchemistproject-backend-608187465720.us-central1.run.app';const defaultResponse=await fetch(`${apiUrl}/advisor-by-id`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({advisor_id:\"ADV001\"})});if(defaultResponse.ok){const defaultResult=await defaultResponse.json();if(defaultResult.advisor){console.log('âœ… Using default advisor ID 1:',defaultResult.advisor);setAdvisorData(defaultResult.advisor);localStorage.setItem('advisor_data',JSON.stringify(defaultResult.advisor));return defaultResult.advisor;}}else{console.error('Default advisor API Error:',defaultResponse.status);}}catch(defaultError){console.error('âŒ Error fetching default advisor:',defaultError);}// Final fallback if database calls fail - use real ADV001 data\nconst fallbackAdvisor={advisor_id:'ADV001',full_name:'John Smith',email:'john.smith@privatebank.com',specialization:'Wealth Management',years_experience:15,location:'New York',isDefault:true,isFallback:true};console.log('âš ï¸  Using hardcoded fallback advisor (ADV001 - John Smith):',fallbackAdvisor);setAdvisorData(fallbackAdvisor);localStorage.setItem('advisor_data',JSON.stringify(fallbackAdvisor));return fallbackAdvisor;}};// Enhanced sign-in with Google OAuth to capture email\nconst signInWithGoogle=()=>{return new Promise((resolve,reject)=>{// COMPREHENSIVE EXCEPTION HANDLING: Multiple fallback layers\ntry{// Try Google OAuth first - this should work on both local and Cloud Run\nconsole.log('ðŸ”„ Attempting Google OAuth authentication...');handleGoogleOAuth(resolve,reject);}catch(globalError){console.error('âŒ CRITICAL: Global authentication error:',globalError);handleFallbackAuthentication(resolve,'Global error occurred');}});};// Demo authentication handler with fallbacks\nconst handleDemoAuthentication=resolve=>{try{// Use ADV001 (John Smith) as default instead of Sarah Johnson\nconst demoUserEmail='john.smith@privatebank.com';const demoUser={email:demoUserEmail,name:'John Smith',credential:'demo_token_'+Date.now()};localStorage.setItem('gcp_token',demoUser.credential);localStorage.setItem('user_email',demoUser.email);localStorage.setItem('user_name',demoUser.name);setToken(demoUser.credential);setUser({authenticated:true,email:demoUser.email,name:demoUser.name,serviceAccount:false});// Fetch real advisor data from database based on email\nfetchAdvisorByEmail(demoUserEmail).then(advisor=>{console.log('âœ… Demo authentication successful with advisor:',advisor===null||advisor===void 0?void 0:advisor.name);resolve({email:demoUser.email,name:demoUser.name,advisor:advisor});}).catch(error=>{console.error('âš ï¸  Demo advisor fetch failed, using fallback:',error);handleFallbackAuthentication(resolve,'Demo advisor fetch failed');});}catch(demoError){console.error('âŒ Demo authentication failed:',demoError);handleFallbackAuthentication(resolve,'Demo authentication failed');}};// Google OAuth handler with comprehensive error handling\nconst handleGoogleOAuth=(resolve,reject)=>{try{// Set a timeout to fallback if Google OAuth doesn't respond\nconst oauthTimeout=setTimeout(()=>{console.warn('â° Google OAuth timeout - falling back to default authentication');handleFallbackAuthentication(resolve,'OAuth timeout');},10000);// 10 second timeout\nif(!window.google){// Load Google Identity Services\nconst script=document.createElement('script');script.src='https://accounts.google.com/gsi/client';script.onload=()=>{clearTimeout(oauthTimeout);initializeGoogleAuth(resolve,reject);};script.onerror=()=>{clearTimeout(oauthTimeout);console.error('âŒ Failed to load Google Identity Services script');handleFallbackAuthentication(resolve,'Google script load failed');};document.head.appendChild(script);}else{clearTimeout(oauthTimeout);initializeGoogleAuth(resolve,reject);}}catch(oauthError){console.error('âŒ Google OAuth setup error:',oauthError);handleFallbackAuthentication(resolve,'OAuth setup error');}};// Initialize Google Auth with error handling\nconst initializeGoogleAuth=(resolve,reject)=>{try{window.google.accounts.id.initialize({client_id:'608187465720-e05scpovhq83mkose0ucmarghctejqdg.apps.googleusercontent.com',callback:async response=>{try{console.log('ðŸ”„ Processing Google authentication response...');// Decode JWT to get user info\nconst payload=JSON.parse(atob(response.credential.split('.')[1]));const userEmail=payload.email;const userName=payload.name;// Store user token and email\nlocalStorage.setItem('gcp_token',response.credential);localStorage.setItem('user_email',userEmail);localStorage.setItem('user_name',userName);setToken(response.credential);setUser({authenticated:true,email:userEmail,name:userName,serviceAccount:false});// Fetch advisor data from BigQuery based on email\ntry{const advisor=await fetchAdvisorByEmail(userEmail);console.log('âœ… Google authentication successful with advisor:',advisor===null||advisor===void 0?void 0:advisor.name);resolve({email:userEmail,name:userName,advisor:advisor});}catch(advisorError){console.error('âš ï¸  Advisor fetch failed after Google auth, using fallback:',advisorError);// Still resolve with user data, advisor will be fallback\nresolve({email:userEmail,name:userName,advisor:null});}}catch(callbackError){console.error('âŒ Error processing Google sign-in callback:',callbackError);handleFallbackAuthentication(resolve,'Google callback processing failed');}},error_callback:error=>{console.error('âŒ Google OAuth error callback:',error);handleFallbackAuthentication(resolve,`Google OAuth error: ${(error===null||error===void 0?void 0:error.type)||'unknown'}`);},auto_select:false});// Try to show the prompt, with fallback if it fails\ntry{window.google.accounts.id.prompt(notification=>{console.log('Google OAuth prompt notification:',notification);if(notification.isNotDisplayed()||notification.isSkippedMoment()){// Show the One Tap UI manually\ntry{const buttonElement=document.getElementById('google-signin-button');if(buttonElement){window.google.accounts.id.renderButton(buttonElement,{type:'standard',size:'large',text:'signin_with',theme:'outline',logo_alignment:'left'});console.log('âœ… Google sign-in button rendered successfully');}else{console.warn('âš ï¸  Google sign-in button element not found');}}catch(renderError){console.error('âŒ Error rendering Google sign-in button:',renderError);}}});}catch(promptError){console.error('âŒ Error showing Google OAuth prompt:',promptError);handleFallbackAuthentication(resolve,'Google prompt failed');}}catch(initError){console.error('âŒ Error initializing Google OAuth:',initError);handleFallbackAuthentication(resolve,'Google OAuth initialization failed');}};// Ultimate fallback authentication - always succeeds\nconst handleFallbackAuthentication=async(resolve,reason)=>{console.log('ðŸ›¡ï¸  FALLBACK AUTHENTICATION ACTIVATED - Reason:',reason);try{// Use ADV001 user info as fallback instead of generic fallback\nconst fallbackUser={email:'john.smith@privatebank.com',// Use ADV001 email\nname:'John Smith',// Use ADV001 name\ncredential:'fallback_token_'+Date.now()};localStorage.setItem('gcp_token',fallbackUser.credential);localStorage.setItem('user_email',fallbackUser.email);localStorage.setItem('user_name',fallbackUser.name);setToken(fallbackUser.credential);setUser({authenticated:true,email:fallbackUser.email,name:fallbackUser.name,serviceAccount:false,isFallback:true});// **FIRST TRY: Fetch advisor ADV001 from database**\ntry{console.log('ðŸ”„ FALLBACK: Attempting to fetch advisor ADV001 from database...');const apiUrl=process.env.REACT_APP_API_URL||'https://apialchemistproject-backend-608187465720.us-central1.run.app';const response=await fetch(`${apiUrl}/advisor-by-id`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({advisor_id:\"ADV001\"})});if(response.ok){const result=await response.json();if(result.advisor){console.log('âœ… FALLBACK SUCCESS: Using advisor ADV001 from database:',result.advisor);setAdvisorData(result.advisor);localStorage.setItem('advisor_data',JSON.stringify(result.advisor));resolve({email:fallbackUser.email,name:fallbackUser.name,advisor:result.advisor,isFallback:true,fallbackReason:reason,advisorSource:'Database advisor ADV001'});return;}}console.warn('âš ï¸  Could not fetch advisor ID 1 from database, using hardcoded fallback');}catch(dbError){console.warn('âš ï¸  Database unavailable for advisor ID 1, using hardcoded fallback:',dbError);}// **SECOND TRY: Use hardcoded fallback advisor only if database fails**\nconst fallbackAdvisor={advisor_id:'ADV001',full_name:'John Smith',email:'john.smith@privatebank.com',specialization:'Wealth Management',years_experience:15,location:'New York',isDefault:true,isFallback:true,isHardcoded:true};setAdvisorData(fallbackAdvisor);localStorage.setItem('advisor_data',JSON.stringify(fallbackAdvisor));console.log('âœ… HARDCODED FALLBACK SUCCESSFUL: ADV001 - John Smith');resolve({email:fallbackUser.email,name:fallbackUser.name,advisor:fallbackAdvisor,isFallback:true,fallbackReason:reason,advisorSource:'Hardcoded ADV001 - John Smith'});}catch(fallbackError){console.error('âŒ CRITICAL: Even fallback authentication failed!',fallbackError);// Last resort - minimal authentication\nresolve({email:'emergency@privatebank.com',name:'Emergency User',advisor:{advisor_id:'EMERGENCY',name:'Emergency Advisor',email:'emergency@privatebank.com',isEmergency:true},isEmergency:true,fallbackReason:'All authentication methods failed',advisorSource:'Emergency mode'});}};// Manual sign-in for development/testing\nconst signInWithToken=idToken=>{localStorage.setItem('gcp_token',idToken);setToken(idToken);setUser({authenticated:true,serviceAccount:false});};const signOut=()=>{localStorage.removeItem('gcp_token');localStorage.removeItem('user_email');localStorage.removeItem('user_name');localStorage.removeItem('advisor_data');setToken(null);setUser(null);setAdvisorData(null);};const getAuthHeaders=()=>{if(!token)return{'Content-Type':'application/json'};return{'Authorization':`Bearer ${token}`,'Content-Type':'application/json'};};// Initialize with saved data on load\nuseEffect(()=>{const savedAdvisor=localStorage.getItem('advisor_data');const savedEmail=localStorage.getItem('user_email');if(savedAdvisor){setAdvisorData(JSON.parse(savedAdvisor));}else if(savedEmail){// Re-fetch advisor data if we have email but no advisor data\nfetchAdvisorByEmail(savedEmail);}},[user]);const value={user,token,loading,advisorData,signInWithToken,signInWithGoogle,signOut,getAuthHeaders,fetchAdvisorByEmail,isAuthenticated:!!user};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","jsx","_jsx","AuthContext","useAuth","context","Error","AuthProvider","_ref","children","user","setUser","token","setToken","loading","setLoading","advisorData","setAdvisorData","initializeAuth","isCloudRun","checkCloudRunEnvironment","backendUrl","process","env","REACT_APP_API_URL","identityToken","getServiceAccountToken","authenticated","serviceAccount","console","log","savedToken","localStorage","getItem","error","message","window","location","hostname","includes","audience","response","fetch","encodeURIComponent","headers","ok","text","status","fetchAdvisorByEmail","email","apiUrl","method","body","JSON","stringify","result","json","advisor","setItem","statusText","defaultResponse","advisor_id","defaultResult","defaultError","fallbackAdvisor","full_name","specialization","years_experience","isDefault","isFallback","signInWithGoogle","Promise","resolve","reject","handleGoogleOAuth","globalError","handleFallbackAuthentication","handleDemoAuthentication","demoUserEmail","demoUser","name","credential","Date","now","then","catch","demoError","oauthTimeout","setTimeout","warn","google","script","document","createElement","src","onload","clearTimeout","initializeGoogleAuth","onerror","head","appendChild","oauthError","accounts","id","initialize","client_id","callback","payload","parse","atob","split","userEmail","userName","advisorError","callbackError","error_callback","type","auto_select","prompt","notification","isNotDisplayed","isSkippedMoment","buttonElement","getElementById","renderButton","size","theme","logo_alignment","renderError","promptError","initError","reason","fallbackUser","fallbackReason","advisorSource","dbError","isHardcoded","fallbackError","isEmergency","signInWithToken","idToken","signOut","removeItem","getAuthHeaders","savedAdvisor","savedEmail","value","isAuthenticated","Provider"],"sources":["/home/prakashb/Prakash/project_hackathon/frontend/src/AuthContextSimple.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\n\nconst AuthContext = createContext();\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [advisorData, setAdvisorData] = useState(null);\n\n  useEffect(() => {\n    const initializeAuth = async () => {\n      try {\n        // First, check if we're running in Cloud Run by testing the metadata server\n        const isCloudRun = await checkCloudRunEnvironment();\n        \n        if (isCloudRun) {\n          // Get service account identity token for the backend\n          const backendUrl = process.env.REACT_APP_API_URL || 'https://apialchemistproject-backend-608187465720.us-central1.run.app';\n          const identityToken = await getServiceAccountToken(backendUrl);\n          \n          if (identityToken) {\n            setToken(identityToken);\n            setUser({ authenticated: true, serviceAccount: true });\n            console.log('Service account authentication successful');\n          } else {\n            throw new Error('Failed to get service account token');\n          }\n        } else {\n          // Local development - use stored token or require sign in\n          const savedToken = localStorage.getItem('gcp_token');\n          if (savedToken) {\n            setToken(savedToken);\n            setUser({ authenticated: true, serviceAccount: false });\n          }\n          // If no saved token, user will need to sign in manually\n        }\n      } catch (error) {\n        console.log('Service account auth not available:', error.message);\n        // Fall back to checking for saved user token\n        const savedToken = localStorage.getItem('gcp_token');\n        if (savedToken) {\n          setToken(savedToken);\n          setUser({ authenticated: true, serviceAccount: false });\n        }\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    initializeAuth();\n  }, []);\n\n  const checkCloudRunEnvironment = async () => {\n    try {\n      // Check if we're on Cloud Run by hostname instead of metadata service\n      const isCloudRun = window.location.hostname.includes('run.app');\n      console.log('ðŸ” Environment check - Cloud Run:', isCloudRun);\n      return isCloudRun;\n    } catch (error) {\n      return false;\n    }\n  };\n\n  const getServiceAccountToken = async (audience) => {\n    try {\n      const response = await fetch(\n        `http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/identity?audience=${encodeURIComponent(audience)}`,\n        {\n          headers: { 'Metadata-Flavor': 'Google' }\n        }\n      );\n      \n      if (response.ok) {\n        return await response.text();\n      } else {\n        throw new Error(`Failed to get token: ${response.status}`);\n      }\n    } catch (error) {\n      console.error('Error getting service account token:', error);\n      return null;\n    }\n  };\n\n  // Function to fetch advisor data by email from BigQuery\n  const fetchAdvisorByEmail = async (email) => {\n    try {\n      const apiUrl = process.env.REACT_APP_API_URL || 'https://apialchemistproject-backend-608187465720.us-central1.run.app';\n      console.log('Fetching advisor for email:', email, 'from API:', apiUrl);\n      \n      const response = await fetch(`${apiUrl}/advisor-by-email`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ email: email })\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        if (result.advisor) {\n          console.log('âœ… Found advisor in database:', result.advisor);\n          setAdvisorData(result.advisor);\n          localStorage.setItem('advisor_data', JSON.stringify(result.advisor));\n          return result.advisor;\n        } else {\n          throw new Error('Advisor not found in database response');\n        }\n      } else {\n        console.error('API Error:', response.status, response.statusText);\n        throw new Error(`API Error: ${response.status}`);\n      }\n    } catch (error) {\n      console.error('âŒ Error fetching advisor data for email:', email, error);\n      \n      // Default to advisor ADV001 (first advisor) from the database\n      try {\n        console.log('ðŸ”„ Attempting to fetch default advisor (ADV001)...');\n        const apiUrl = process.env.REACT_APP_API_URL || 'https://apialchemistproject-backend-608187465720.us-central1.run.app';\n        \n        const defaultResponse = await fetch(`${apiUrl}/advisor-by-id`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({ advisor_id: \"ADV001\" })\n        });\n\n        if (defaultResponse.ok) {\n          const defaultResult = await defaultResponse.json();\n          if (defaultResult.advisor) {\n            console.log('âœ… Using default advisor ID 1:', defaultResult.advisor);\n            setAdvisorData(defaultResult.advisor);\n            localStorage.setItem('advisor_data', JSON.stringify(defaultResult.advisor));\n            return defaultResult.advisor;\n          }\n        } else {\n          console.error('Default advisor API Error:', defaultResponse.status);\n        }\n      } catch (defaultError) {\n        console.error('âŒ Error fetching default advisor:', defaultError);\n      }\n\n      // Final fallback if database calls fail - use real ADV001 data\n      const fallbackAdvisor = {\n        advisor_id: 'ADV001',\n        full_name: 'John Smith',\n        email: 'john.smith@privatebank.com',\n        specialization: 'Wealth Management',\n        years_experience: 15,\n        location: 'New York',\n        isDefault: true,\n        isFallback: true\n      };\n      console.log('âš ï¸  Using hardcoded fallback advisor (ADV001 - John Smith):', fallbackAdvisor);\n      setAdvisorData(fallbackAdvisor);\n      localStorage.setItem('advisor_data', JSON.stringify(fallbackAdvisor));\n      return fallbackAdvisor;\n    }\n  };\n\n  // Enhanced sign-in with Google OAuth to capture email\n  const signInWithGoogle = () => {\n    return new Promise((resolve, reject) => {\n      // COMPREHENSIVE EXCEPTION HANDLING: Multiple fallback layers\n      \n      try {\n        // Try Google OAuth first - this should work on both local and Cloud Run\n        console.log('ðŸ”„ Attempting Google OAuth authentication...');\n        handleGoogleOAuth(resolve, reject);\n        \n      } catch (globalError) {\n        console.error('âŒ CRITICAL: Global authentication error:', globalError);\n        handleFallbackAuthentication(resolve, 'Global error occurred');\n      }\n    });\n  };\n\n  // Demo authentication handler with fallbacks\n  const handleDemoAuthentication = (resolve) => {\n    try {\n      // Use ADV001 (John Smith) as default instead of Sarah Johnson\n      const demoUserEmail = 'john.smith@privatebank.com';\n      const demoUser = {\n        email: demoUserEmail,\n        name: 'John Smith',\n        credential: 'demo_token_' + Date.now()\n      };\n      \n      localStorage.setItem('gcp_token', demoUser.credential);\n      localStorage.setItem('user_email', demoUser.email);\n      localStorage.setItem('user_name', demoUser.name);\n      \n      setToken(demoUser.credential);\n      setUser({\n        authenticated: true,\n        email: demoUser.email,\n        name: demoUser.name,\n        serviceAccount: false\n      });\n      \n      // Fetch real advisor data from database based on email\n      fetchAdvisorByEmail(demoUserEmail)\n        .then((advisor) => {\n          console.log('âœ… Demo authentication successful with advisor:', advisor?.name);\n          resolve({\n            email: demoUser.email,\n            name: demoUser.name,\n            advisor: advisor\n          });\n        })\n        .catch((error) => {\n          console.error('âš ï¸  Demo advisor fetch failed, using fallback:', error);\n          handleFallbackAuthentication(resolve, 'Demo advisor fetch failed');\n        });\n        \n    } catch (demoError) {\n      console.error('âŒ Demo authentication failed:', demoError);\n      handleFallbackAuthentication(resolve, 'Demo authentication failed');\n    }\n  };\n\n  // Google OAuth handler with comprehensive error handling\n  const handleGoogleOAuth = (resolve, reject) => {\n    try {\n      // Set a timeout to fallback if Google OAuth doesn't respond\n      const oauthTimeout = setTimeout(() => {\n        console.warn('â° Google OAuth timeout - falling back to default authentication');\n        handleFallbackAuthentication(resolve, 'OAuth timeout');\n      }, 10000); // 10 second timeout\n\n      if (!window.google) {\n        // Load Google Identity Services\n        const script = document.createElement('script');\n        script.src = 'https://accounts.google.com/gsi/client';\n        script.onload = () => {\n          clearTimeout(oauthTimeout);\n          initializeGoogleAuth(resolve, reject);\n        };\n        script.onerror = () => {\n          clearTimeout(oauthTimeout);\n          console.error('âŒ Failed to load Google Identity Services script');\n          handleFallbackAuthentication(resolve, 'Google script load failed');\n        };\n        document.head.appendChild(script);\n      } else {\n        clearTimeout(oauthTimeout);\n        initializeGoogleAuth(resolve, reject);\n      }\n    } catch (oauthError) {\n      console.error('âŒ Google OAuth setup error:', oauthError);\n      handleFallbackAuthentication(resolve, 'OAuth setup error');\n    }\n  };\n\n  // Initialize Google Auth with error handling\n  const initializeGoogleAuth = (resolve, reject) => {\n    try {\n      window.google.accounts.id.initialize({\n        client_id: '608187465720-e05scpovhq83mkose0ucmarghctejqdg.apps.googleusercontent.com',\n        callback: async (response) => {\n          try {\n            console.log('ðŸ”„ Processing Google authentication response...');\n            \n            // Decode JWT to get user info\n            const payload = JSON.parse(atob(response.credential.split('.')[1]));\n            const userEmail = payload.email;\n            const userName = payload.name;\n\n            // Store user token and email\n            localStorage.setItem('gcp_token', response.credential);\n            localStorage.setItem('user_email', userEmail);\n            localStorage.setItem('user_name', userName);\n\n            setToken(response.credential);\n            setUser({\n              authenticated: true,\n              email: userEmail,\n              name: userName,\n              serviceAccount: false\n            });\n\n            // Fetch advisor data from BigQuery based on email\n            try {\n              const advisor = await fetchAdvisorByEmail(userEmail);\n              console.log('âœ… Google authentication successful with advisor:', advisor?.name);\n              \n              resolve({\n                email: userEmail,\n                name: userName,\n                advisor: advisor\n              });\n            } catch (advisorError) {\n              console.error('âš ï¸  Advisor fetch failed after Google auth, using fallback:', advisorError);\n              // Still resolve with user data, advisor will be fallback\n              resolve({\n                email: userEmail,\n                name: userName,\n                advisor: null\n              });\n            }\n            \n          } catch (callbackError) {\n            console.error('âŒ Error processing Google sign-in callback:', callbackError);\n            handleFallbackAuthentication(resolve, 'Google callback processing failed');\n          }\n        },\n        error_callback: (error) => {\n          console.error('âŒ Google OAuth error callback:', error);\n          handleFallbackAuthentication(resolve, `Google OAuth error: ${error?.type || 'unknown'}`);\n        },\n        auto_select: false,\n      });\n\n      // Try to show the prompt, with fallback if it fails\n      try {\n        window.google.accounts.id.prompt((notification) => {\n          console.log('Google OAuth prompt notification:', notification);\n          \n          if (notification.isNotDisplayed() || notification.isSkippedMoment()) {\n            // Show the One Tap UI manually\n            try {\n              const buttonElement = document.getElementById('google-signin-button');\n              if (buttonElement) {\n                window.google.accounts.id.renderButton(buttonElement, {\n                  type: 'standard',\n                  size: 'large',\n                  text: 'signin_with',\n                  theme: 'outline',\n                  logo_alignment: 'left',\n                });\n                console.log('âœ… Google sign-in button rendered successfully');\n              } else {\n                console.warn('âš ï¸  Google sign-in button element not found');\n              }\n            } catch (renderError) {\n              console.error('âŒ Error rendering Google sign-in button:', renderError);\n            }\n          }\n        });\n      } catch (promptError) {\n        console.error('âŒ Error showing Google OAuth prompt:', promptError);\n        handleFallbackAuthentication(resolve, 'Google prompt failed');\n      }\n      \n    } catch (initError) {\n      console.error('âŒ Error initializing Google OAuth:', initError);\n      handleFallbackAuthentication(resolve, 'Google OAuth initialization failed');\n    }\n  };\n\n  // Ultimate fallback authentication - always succeeds\n  const handleFallbackAuthentication = async (resolve, reason) => {\n    console.log('ðŸ›¡ï¸  FALLBACK AUTHENTICATION ACTIVATED - Reason:', reason);\n    \n    try {\n      // Use ADV001 user info as fallback instead of generic fallback\n      const fallbackUser = {\n        email: 'john.smith@privatebank.com', // Use ADV001 email\n        name: 'John Smith', // Use ADV001 name\n        credential: 'fallback_token_' + Date.now()\n      };\n      \n      localStorage.setItem('gcp_token', fallbackUser.credential);\n      localStorage.setItem('user_email', fallbackUser.email);\n      localStorage.setItem('user_name', fallbackUser.name);\n      \n      setToken(fallbackUser.credential);\n      setUser({\n        authenticated: true,\n        email: fallbackUser.email,\n        name: fallbackUser.name,\n        serviceAccount: false,\n        isFallback: true\n      });\n      \n      // **FIRST TRY: Fetch advisor ADV001 from database**\n      try {\n        console.log('ðŸ”„ FALLBACK: Attempting to fetch advisor ADV001 from database...');\n        const apiUrl = process.env.REACT_APP_API_URL || 'https://apialchemistproject-backend-608187465720.us-central1.run.app';\n        \n        const response = await fetch(`${apiUrl}/advisor-by-id`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({ advisor_id: \"ADV001\" })\n        });\n\n        if (response.ok) {\n          const result = await response.json();\n          if (result.advisor) {\n            console.log('âœ… FALLBACK SUCCESS: Using advisor ADV001 from database:', result.advisor);\n            setAdvisorData(result.advisor);\n            localStorage.setItem('advisor_data', JSON.stringify(result.advisor));\n            \n            resolve({\n              email: fallbackUser.email,\n              name: fallbackUser.name,\n              advisor: result.advisor,\n              isFallback: true,\n              fallbackReason: reason,\n              advisorSource: 'Database advisor ADV001'\n            });\n            return;\n          }\n        }\n        console.warn('âš ï¸  Could not fetch advisor ID 1 from database, using hardcoded fallback');\n      } catch (dbError) {\n        console.warn('âš ï¸  Database unavailable for advisor ID 1, using hardcoded fallback:', dbError);\n      }\n      \n      // **SECOND TRY: Use hardcoded fallback advisor only if database fails**\n      const fallbackAdvisor = {\n        advisor_id: 'ADV001',\n        full_name: 'John Smith',\n        email: 'john.smith@privatebank.com',\n        specialization: 'Wealth Management',\n        years_experience: 15,\n        location: 'New York',\n        isDefault: true,\n        isFallback: true,\n        isHardcoded: true\n      };\n      \n      setAdvisorData(fallbackAdvisor);\n      localStorage.setItem('advisor_data', JSON.stringify(fallbackAdvisor));\n      \n      console.log('âœ… HARDCODED FALLBACK SUCCESSFUL: ADV001 - John Smith');\n      \n      resolve({\n        email: fallbackUser.email,\n        name: fallbackUser.name,\n        advisor: fallbackAdvisor,\n        isFallback: true,\n        fallbackReason: reason,\n        advisorSource: 'Hardcoded ADV001 - John Smith'\n      });\n      \n    } catch (fallbackError) {\n      console.error('âŒ CRITICAL: Even fallback authentication failed!', fallbackError);\n      // Last resort - minimal authentication\n      resolve({\n        email: 'emergency@privatebank.com',\n        name: 'Emergency User',\n        advisor: {\n          advisor_id: 'EMERGENCY',\n          name: 'Emergency Advisor',\n          email: 'emergency@privatebank.com',\n          isEmergency: true\n        },\n        isEmergency: true,\n        fallbackReason: 'All authentication methods failed',\n        advisorSource: 'Emergency mode'\n      });\n    }\n  };\n\n  // Manual sign-in for development/testing\n  const signInWithToken = (idToken) => {\n    localStorage.setItem('gcp_token', idToken);\n    setToken(idToken);\n    setUser({ authenticated: true, serviceAccount: false });\n  };\n\n  const signOut = () => {\n    localStorage.removeItem('gcp_token');\n    localStorage.removeItem('user_email');\n    localStorage.removeItem('user_name');\n    localStorage.removeItem('advisor_data');\n    setToken(null);\n    setUser(null);\n    setAdvisorData(null);\n  };\n\n  const getAuthHeaders = () => {\n    if (!token) return { 'Content-Type': 'application/json' };\n    \n    return {\n      'Authorization': `Bearer ${token}`,\n      'Content-Type': 'application/json'\n    };\n  };\n\n  // Initialize with saved data on load\n  useEffect(() => {\n    const savedAdvisor = localStorage.getItem('advisor_data');\n    const savedEmail = localStorage.getItem('user_email');\n    \n    if (savedAdvisor) {\n      setAdvisorData(JSON.parse(savedAdvisor));\n    } else if (savedEmail) {\n      // Re-fetch advisor data if we have email but no advisor data\n      fetchAdvisorByEmail(savedEmail);\n    }\n  }, [user]);\n\n  const value = {\n    user,\n    token,\n    loading,\n    advisorData,\n    signInWithToken,\n    signInWithGoogle,\n    signOut,\n    getAuthHeaders,\n    fetchAdvisorByEmail,\n    isAuthenticated: !!user\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}